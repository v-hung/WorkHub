import{r as m,a as v,j as e,f as C,h as R,B as F}from"./index--uR3bosk.js";import{w as T}from"./loader-C4fNgBr5.js";import{P as y,p as k}from"./error.utils-BlwQgnKf.js";import{u as M}from"./useProjectAction-g1uFLqo6.js";import{T as U}from"./TeamSelect-DW5BM7kK.js";import{a as f}from"./UserSelect-C6Zfnbmt.js";import{D as B}from"./DatePicker-C7I8Jg0m.js";import{F as r,R as E,C as a}from"./index-BgZba38B.js";import{I as h}from"./index-0qdCREwA.js";import{S as L}from"./index-Cw5KyAVY.js";import{S as N}from"./index-D5u-G5-S.js";import{w as A}from"./auth.store-DCyo43Do.js";import{P as g}from"./Permission-BrgRu2qR.js";import{D as H,a as V,b as q}from"./DefaultContent-rY5y8PUg.js";import{D as G}from"./DefaultBreadcrumb-DHRDwWi8.js";import{e as P}from"./hasPermission-A1V7tTeH.js";import{F as O}from"./save-outline-BtesEFZG.js";import"./SelectAsyncScroll-CqaChjMP.js";import"./common.utils-DPZ9yX3U.js";import"./useTeams-CPTViS0J.js";import"./validate.utils-ciPUpZAo.js";import"./useUsers-DFLz3FjB.js";import"./typeof-C5VrKZhV.js";import"./dropdown-Dl8K4053.js";import"./index-c0GfCdz7.js";import"./EllipsisOutlined-BTocrDpt.js";import"./index-f1v-kFPc.js";import"./collapse-BbEVqHco.js";import"./Input-CZqVGBfN.js";import"./useVariants-BuS53gwb.js";import"./useIcons-BCjpvc7O.js";import"./DownOutlined-DmCfGseC.js";import"./useBreakpoint-CJq1a_UD.js";const{RangePicker:$}=B,z=$,J=m.forwardRef((s,o)=>{const{className:i,record:t,setLoading:n,...b}=s,j=v(),{loading:p,create:I,update:S,formDefault:w}=M();m.useEffect(()=>{n&&n(p)},[p,n]);const[d]=r.useForm(),[D]=m.useState(w(t));return m.useImperativeHandle(o,()=>({handelUpsert(){d.validateFields().then(async()=>{var u,x;const l=d.getFieldsValue(),c={...l,startDate:((u=l.completionTime)==null?void 0:u[0])||null,endDate:((x=l.completionTime)==null?void 0:x[1])||null};t?await S(t.id,c,()=>j("/projects")):await I(c,()=>j("/projects"))})}})),e.jsxs("div",{...b,className:`form-container ${i}`,children:[e.jsx(r,{layout:"vertical",form:d,initialValues:D,validateTrigger:"onSubmit",children:e.jsxs(E,{wrap:!0,gutter:{sm:8,md:16},children:[e.jsx(a,{xs:24,lg:12,children:e.jsx(r.Item,{label:"Project name",name:"name",rules:[{required:!0}],children:e.jsx(h,{placeholder:"name"})})}),e.jsx(a,{xs:24,children:e.jsx(r.Item,{label:"Description",name:"description",children:e.jsx(h,{placeholder:"description"})})}),e.jsx(a,{xs:24,lg:12,children:e.jsx(r.Item,{label:"Completion Time",name:"completionTime",children:e.jsx(z,{})})}),e.jsx(a,{xs:24,lg:12,xl:8,children:e.jsx(r.Item,{label:"Status",name:"status",children:e.jsx(L,{options:Object.entries(y).map(([l,c])=>({value:c,label:l}))})})}),e.jsx(a,{xs:24,lg:12,xl:8,children:e.jsx(r.Item,{label:"Team",name:"teamId",children:e.jsx(U,{})})}),e.jsx(a,{xs:24,lg:12,xl:8,children:e.jsx(r.Item,{label:"Manager",name:"managerId",rules:[{required:!0}],children:e.jsx(f,{})})}),e.jsx(a,{xs:24,lg:12,xl:8,children:e.jsx(r.Item,{label:"Members",name:"memberIds",children:e.jsx(f,{mode:"multiple"})})})]})}),p&&e.jsx("div",{className:"loading-container",children:e.jsx(N,{})})]})}),Ce=T(async({params:s},{permissions:o})=>{const{id:i}=s;if(!i)return P(o,g.PermissionsProjectsCreate),null;P(o,g.PermissionsProjectsEdit);const t=await A(()=>k.projectGetById({id:+i}));if(!t)throw C("/projects");return t});function Re(){const s=R(),[o,i]=m.useState(!1),t=m.useRef(null),n=()=>{t.current&&t.current.handelUpsert()};return e.jsxs(H,{children:[e.jsx(V,{title:s?"Update project":"Create project",children:e.jsx(F,{type:"primary",icon:e.jsx(O,{width:16,height:16}),onClick:n,loading:o,children:"Save"})}),e.jsx(G,{items:[{title:"Home",path:"/"},{title:"Projects Manager",path:"/projects"},{title:s?"Update project":"Create project"}]}),e.jsx(q,{children:e.jsx(J,{ref:t,setLoading:i,record:s})})]})}export{Re as Component,Ce as loader};
