import{r as m,j as e,a as y,f as S,h as F,B as v}from"./index--uR3bosk.js";import{w as C}from"./loader-C4fNgBr5.js";import{u as N}from"./useWorkTimeAction-DzoegdtV.js";import{s as V}from"./TimePicker.module-D3qUlonp.js";import{D as E}from"./DatePicker-C7I8Jg0m.js";import{l as u,f as c}from"./date.utils-CRd9Tq6_.js";import{F as a,R as H,C as l}from"./index-BgZba38B.js";import{I as x}from"./index-0qdCREwA.js";import{S as I}from"./index-D5u-G5-S.js";import{w as R}from"./error.utils-BlwQgnKf.js";import{w as A}from"./auth.store-DCyo43Do.js";import{P as g}from"./Permission-BrgRu2qR.js";import{D as M,a as W,b as q}from"./DefaultContent-rY5y8PUg.js";import{D as L}from"./DefaultBreadcrumb-DHRDwWi8.js";import{e as j}from"./hasPermission-A1V7tTeH.js";import{F as B}from"./save-outline-BtesEFZG.js";import"./typeof-C5VrKZhV.js";import"./dropdown-Dl8K4053.js";import"./index-c0GfCdz7.js";import"./EllipsisOutlined-BTocrDpt.js";import"./index-f1v-kFPc.js";import"./collapse-BbEVqHco.js";import"./Input-CZqVGBfN.js";import"./useVariants-BuS53gwb.js";import"./useIcons-BCjpvc7O.js";import"./DownOutlined-DmCfGseC.js";import"./startOfDay-DVNVffkj.js";import"./en-US-BRWW7OjM.js";import"./buildMatchPatternFn-DF4FdbSS.js";import"./useBreakpoint-CJq1a_UD.js";import"./common.utils-DPZ9yX3U.js";const d=m.forwardRef((t,s)=>{const{popupClassName:o,...i}=t;return e.jsx(E,{popupClassName:`${V.customPopupTimePicker} ${o??""}`,...i,picker:"time",mode:void 0,ref:s})});d.displayName="TimePicker";const O=[0,10,20,30,40,50],p=()=>({disabledHours:()=>[],disabledMinutes:()=>Array.from({length:60},(t,s)=>s).filter(t=>!O.includes(t)),disabledSeconds:()=>Array.from({length:59},(t,s)=>s+1)}),U=m.forwardRef((t,s)=>{const{className:o,record:i,setLoading:n,...k}=t,w=y(),{loading:f,create:b,update:T,formDefault:P}=N();m.useEffect(()=>{n&&n(f)},[f,n]);const[h]=a.useForm(),[D]=m.useState(P(i));return m.useImperativeHandle(s,()=>({handelUpsert(){h.validateFields().then(async()=>{const r=h.getFieldsValue();i?await T(i.id,r,()=>w("/work-times")):await b(r,()=>w("/work-times"))})}})),e.jsxs("div",{...k,className:`form-container ${o}`,children:[e.jsx(a,{layout:"vertical",form:h,initialValues:D,validateTrigger:"onSubmit",children:e.jsxs(H,{wrap:!0,gutter:{sm:8,md:16},children:[e.jsx(l,{xs:24,lg:12,children:e.jsx(a.Item,{label:"Work time title",name:"title",rules:[{required:!0}],children:e.jsx(x,{placeholder:"title"})})}),e.jsx(l,{span:24}),e.jsx(l,{xs:24,lg:12,children:e.jsx(a.Item,{label:"Start time morning",name:"startTimeMorning",rules:[{required:!0}],getValueFromEvent:r=>r&&c(r),getValueProps:r=>({value:r?u(r):null}),children:e.jsx(d,{style:{width:"100%"},disabledTime:p,hideDisabledOptions:!0,showSecond:!1,showNow:!1})})}),e.jsx(l,{xs:24,lg:12,children:e.jsx(a.Item,{label:"End time morning",name:"endTimeMorning",rules:[{required:!0}],getValueFromEvent:r=>r&&c(r),getValueProps:r=>({value:r?u(r):null}),children:e.jsx(d,{style:{width:"100%"},disabledTime:p,format:"HH:mm:ss",hideDisabledOptions:!0,showSecond:!1,showNow:!1})})}),e.jsx(l,{xs:24,lg:12,children:e.jsx(a.Item,{label:"Start time afternoon",name:"startTimeAfternoon",rules:[{required:!0}],getValueFromEvent:r=>r&&c(r),getValueProps:r=>({value:r?u(r):null}),children:e.jsx(d,{style:{width:"100%"},disabledTime:p,format:"HH:mm:ss",hideDisabledOptions:!0,showSecond:!1,showNow:!1})})}),e.jsx(l,{xs:24,lg:12,children:e.jsx(a.Item,{label:"End time afternoon",name:"endTimeAfternoon",rules:[{required:!0}],getValueFromEvent:r=>r&&c(r),getValueProps:r=>({value:r?u(r):null}),children:e.jsx(d,{style:{width:"100%"},disabledTime:p,format:"HH:mm:ss",hideDisabledOptions:!0,showSecond:!1,showNow:!1})})}),e.jsx(l,{xs:24,lg:12,children:e.jsx(a.Item,{label:"Allowed late minutes",name:"allowedLateMinutes",children:e.jsx(x,{type:"number"})})})]})}),f&&e.jsx("div",{className:"loading-container",children:e.jsx(I,{})})]})}),be=C(async({params:t},{permissions:s})=>{const{id:o}=t;if(!o)return j(s,g.PermissionsWorkTimesCreate),null;j(s,g.PermissionsWorkTimesEdit);const i=await A(()=>R.workTimeGetById({id:+o}));if(!i)throw S("/work-times");return i});function Te(){const t=F(),[s,o]=m.useState(!1),i=m.useRef(null),n=()=>{i.current&&i.current.handelUpsert()};return e.jsxs(M,{children:[e.jsx(W,{title:t?"Update work time":"Create work time",children:e.jsx(v,{type:"primary",icon:e.jsx(B,{width:16,height:16}),onClick:n,loading:s,children:"Save"})}),e.jsx(L,{items:[{title:"Home",path:"/"},{title:"Work times Manager",path:"/work-times"},{title:t?"Update work time":"Create work time"}]}),e.jsx(q,{children:e.jsx(U,{ref:i,setLoading:o,record:t})})]})}export{Te as Component,be as loader};
